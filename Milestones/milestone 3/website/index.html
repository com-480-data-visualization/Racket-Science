<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Racket Science</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/goat_poll.css">
    <link rel="stylesheet" href="css/cover_page.css">
</head>
<body>

  <section id="cover">
        <video autoplay loop muted playsinline id="cover-video">
            <source src="tennis_court3.mp4" type="video/mp4">
        </video>
        <div class="cover-content">
            <h1>Racket Science</h1>
            <p>Welcome! Scroll and discover who is the GOAT üêê</p>
            <a href="#main-content" class="scroll-down">‚ñº</a>
        </div>
        <div class="cover-fade"></div>
    
  </section>

  <div id="main-content"></div>
  <div id="transition-overlay" style="display: none;">
    <img src="images/tennis-ball.png" id="bouncing-ball" />
  </div>
<nav>
    <ul class="width-limited">
        <li><a href="index.html"class="active">Global</a></li>
        <li><a href="doubles.html">Doubles</a></li>
        <li><a href="surfaces.html">Surfaces</a></li>
        <li><a href="services.html">Services</a></li>
        <li><a href="net.html">Net</a></li>
        <li><a href="tournament.html">Tournament</a></li>
        <li><a href="compare.html">Compare</a></li>
    </ul>
</nav>
<header>
    <h1>Overall GOAT</h1>
</header>


<main class="charts-wrapper">
    <div class="top-charts">
        <section class="chart-container top-chart" id="podium">
            <div class="chart-header">
            <select id="year-select">
                <option value="Overall years">Overall years</option>
                <option value="2024">2024</option>
                <option value="2023">2023</option>
                <option value="2022">2022</option>
                <option value="2021">2021</option>
                <option value="2020">2020</option>
                <option value="2019">2019</option>
                <option value="2018">2018</option>
                <option value="2017">2017</option>
                <option value="2016">2016</option>
                <option value="2015">2015</option>
                <option value="2014">2014</option>
                <option value="2013">2013</option>
                <option value="2012">2012</option>
            </select>
        
            <select id="tournament-select">
                <option value="Overall tournaments">Overall tournaments</option>
                <option>tournament1</option>
                <option>tournament2</option>
                <option>tournament3</option>
            </select>
            </div>
        
            <div class="chart-content">
            <h2>Podium</h2>
            <div class="scoreboard">
                <div class="scoreboard__podiums">
                  <div class="scoreboard__podium js-podium" data-height="200px">
                    <div class="scoreboard__podium-base scoreboard__podium-base--second">
                      <div class="scoreboard__podium-rank">2</div>
                    </div>
                    <div class="scoreboard__podium-number">
                      Novak Djokovic
                      <small><span class="js-podium-data">160</span></small>
                    </div>
                  </div>
                  <div class="scoreboard__podium js-podium" data-height="250px">
                    <div class="scoreboard__podium-base scoreboard__podium-base--first">
                      <div class="scoreboard__podium-rank">1</div>
                    </div>
                    <div class="scoreboard__podium-number">
                      Roger Federer
                      <small><span class="js-podium-data">195</span></small>
                    </div>
                  </div>
                  <div class="scoreboard__podium js-podium" data-height="150px">
                    <div class="scoreboard__podium-base scoreboard__podium-base--third">
                      <div class="scoreboard__podium-rank">3</div>
                    </div>
                    <div class="scoreboard__podium-number">
                      Rafael Nadal
                      <small><span class="js-podium-data">100</span></small>
                    </div>
                  </div>
                </div>
              </div>
            </div>
        </section>

        <section class="chart-container top-chart" id="over_the_years ">
            <div class="chart-header">
                <select id="year-select2">
                    <option value="Overall years">Overall years</option>
                    <option value="2024">2024</option>
                    <option value="2023">2023</option>
                    <option value="2022">2022</option>
                    <option value="2021">2021</option>
                    <option value="2020">2020</option>
                    <option value="2019">2019</option>
                    <option value="2018">2018</option>
                    <option value="2017">2017</option>
                    <option value="2016">2016</option>
                    <option value="2015">2015</option>
                    <option value="2014">2014</option>
                    <option value="2013">2013</option>
                    <option value="2012">2012</option>
                </select>
            
                <select id="tournament-select2">
                    <option value="Overall tournaments">Overall tournaments</option>
                    <option>tournament1</option>
                    <option>tournament2</option>
                    <option>tournament3</option>
                </select>
            </div>

        
            <div class="chart-content">
                <h2>Evolution over the years</h2>
                <svg id="bubble-chart" width="500" height="400"></svg>
            </div>
        </section>

        <section class="chart-container top-chart" id="radar-chart-section">
            <div class="chart-header">
                <select id="year-select2">
                    <option value="Overall years">Overall years</option>
                    <option value="2024">2024</option>
                    <option value="2023">2023</option>
                    <option value="2022">2022</option>
                    <option value="2021">2021</option>
                    <option value="2020">2020</option>
                    <option value="2019">2019</option>
                    <option value="2018">2018</option>
                    <option value="2017">2017</option>
                    <option value="2016">2016</option>
                    <option value="2015">2015</option>
                    <option value="2014">2014</option>
                    <option value="2013">2013</option>
                    <option value="2012">2012</option>
                </select>
            </div>

            <div class="chart-content">
                <h2>Top Players' Performance</h2>
                <canvas id="radarCanvas" width="350" height="350"></canvas>
            </div>
          </section>

          <div class="nav-dots">
            <span class="dot" onclick="goToChart(1)"></span>
            <span class="dot" onclick="goToChart(2)"></span>
            <span class="dot" onclick="goToChart(3)"></span>
        </div>
    </div>

    

    <h2 style="text-align:center;"> You do not agree with the above ranking ? Vote for your GOAT!</h2>

    <div class="vote-form">
    <select id="player-category">
      <option value="all">All Players</option>
      <option value="men">Men</option>
      <option value="women">Women</option>
    </select>

    <select id="player-select"></select>
    <input type="text" id="player-name" placeholder="Enter your GOAT's name" style="display:none;">
    <button id="vote-button" type="button">Vote üéæ</button>
  </div>
  <div id="vote-feedback" style="margin-top:0.5em; font-weight:500;"></div>

  <div class="bottom-charts">
    <section class="chart-container">
      <div class="chart-content">
        <h2>Let the users vote</h2>
        <canvas id="goatVoteChart" width="650" height="300"></canvas>
      </div>
    </section>
  </div>
</main>
</div>

<footer>
    
    <p>&copy; 2025 - We hope this site is an ace. Proudly served with love by R√©za Machraoui, Luna Ralet & Leila Sidjanski.</p>
</footer>

<!-- Optionally load a library like D3.js or Chart.js -->
<!-- <script src="https://d3js.org/d3.v7.min.js"></script> -->

<script src="https://cdn.jsdelivr.net/npm/chart.js@4/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<script>
  async function resetAllVotesToZero() {
    const { data, error } = await supabase
      .from('votes')
      .select('id');

    if (error) {
      console.error('Failed to fetch votes:', error);
      return;
    }

    for (const vote of data) {
      await supabase
        .from('votes')
        .update({ count: 0 })
        .eq('id', vote.id);
    }

    console.log("‚úÖ All votes reset to 0.");
  }

  // Run once before launch:
  // resetAllVotesToZero();
</script>
<script src="js/goat_poll.js"></script>
<script src="js/main.js"></script>
<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>


<script>
  const overlay = document.getElementById('transition-overlay');
  const ball = document.getElementById('bouncing-ball');

  function animateBounceAndNavigate(url) {
    overlay.style.display = 'block';

    let x = 0;
    let y = 0;
    let vx = 12; // X speed
    let vy = 9; // Y speed
    const ballSize = 60;

    const screenW = window.innerWidth;
    const screenH = window.innerHeight;

    const interval = setInterval(() => {
      x += vx;
      y += vy;

      if (x + ballSize >= screenW || x <= 0) vx *= -1;
      if (y + ballSize >= screenH || y <= 0) vy *= -1;

      ball.style.left = `${x}px`;
      ball.style.top = `${y}px`;
    }, 16); // ~60fps

    // Stop after 2 seconds and navigate
    setTimeout(() => {
      clearInterval(interval);
      window.location.href = url;
    }, 2000);
  }

  document.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', function (e) {
      const href = this.getAttribute('href');

      // Allow internal scroll (like #main-content)
      if (href && href.startsWith('#')) return;

      // Only animate for internal page navigations
      if (this.href && this.href.startsWith(window.location.origin)) {
        e.preventDefault();
        animateBounceAndNavigate(this.href);
      }
    });
  });
</script>
</body>
</html>
